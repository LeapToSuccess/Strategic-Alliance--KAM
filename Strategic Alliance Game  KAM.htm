<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List
href="Strategic%20Alliance%20Game%20%20KAM_files/filelist.xml">
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>mahmoud iskandarani</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>mahmoud iskandarani</o:LastAuthor>
  <o:Revision>1</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2025-10-22T08:19:00Z</o:Created>
  <o:LastSaved>2025-10-22T08:20:00Z</o:LastSaved>
  <o:Pages>41</o:Pages>
  <o:Words>6115</o:Words>
  <o:Characters>34860</o:Characters>
  <o:Lines>290</o:Lines>
  <o:Paragraphs>81</o:Paragraphs>
  <o:CharactersWithSpaces>40894</o:CharactersWithSpaces>
  <o:Version>16.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData
href="Strategic%20Alliance%20Game%20%20KAM_files/themedata.thmx">
<link rel=colorSchemeMapping
href="Strategic%20Alliance%20Game%20%20KAM_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>AR-SA</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" DefPriority="99"
  LatentStyleCount="376">
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 9"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="header"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footer"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index heading"/>
  <w:LsdException Locked="false" Priority="35" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of figures"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope return"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="line number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="page number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of authorities"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="macro"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="toa heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 5"/>
  <w:LsdException Locked="false" Priority="10" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Closing"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Signature"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="true"
   UnhideWhenUsed="true" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Message Header"/>
  <w:LsdException Locked="false" Priority="11" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Salutation"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Date"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Note Heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Block Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="FollowedHyperlink"/>
  <w:LsdException Locked="false" Priority="22" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Document Map"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Plain Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="E-mail Signature"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Top of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal (Web)"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Acronym"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Cite"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Code"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Definition"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Keyboard"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Preformatted"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Sample"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Typewriter"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Variable"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Table"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation subject"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="No List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Contemporary"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Elegant"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Professional"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Balloon Text"/>
  <w:LsdException Locked="false" Priority="39" Name="Table Grid"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Theme"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hashtag"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Unresolved Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Link"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536869121 1107305727 33554432 0 415 0;}
@font-face
	{font-family:Aptos;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 3 0 0 415 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:Arial;
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:18.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:20.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h2
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 2 Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h3
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 3 Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:14.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h4
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 4 Char";
	mso-style-next:Normal;
	margin-top:4.0pt;
	margin-right:0cm;
	margin-bottom:2.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;
	font-style:italic;}
h5
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 5 Char";
	mso-style-next:Normal;
	margin-top:4.0pt;
	margin-right:0cm;
	margin-bottom:2.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h6
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 6 Char";
	mso-style-next:Normal;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 7 Char";
	mso-style-next:Normal;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 8 Char";
	mso-style-next:Normal;
	margin:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 9 Char";
	mso-style-next:Normal;
	margin:0cm;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:9;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Subtitle Char";
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	letter-spacing:.75pt;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:Arial;
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:Arial;
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:Arial;
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:Arial;
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoQuote, li.MsoQuote, div.MsoQuote
	{mso-style-priority:29;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Quote Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:Arial;
	mso-bidi-theme-font:minor-bidi;
	color:#404040;
	mso-themecolor:text1;
	mso-themetint:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-style:italic;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Intense Quote Char";
	mso-style-next:Normal;
	margin-top:18.0pt;
	margin-right:43.2pt;
	margin-bottom:18.0pt;
	margin-left:43.2pt;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan;
	border:none;
	mso-border-top-alt:solid #0F4761 .5pt;
	mso-border-top-themecolor:accent1;
	mso-border-top-themeshade:191;
	mso-border-bottom-alt:solid #0F4761 .5pt;
	mso-border-bottom-themecolor:accent1;
	mso-border-bottom-themeshade:191;
	padding:0cm;
	mso-padding-alt:10.0pt 0cm 10.0pt 0cm;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:Arial;
	mso-bidi-theme-font:minor-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-style:italic;}
span.MsoIntenseEmphasis
	{mso-style-priority:21;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.MsoIntenseReference
	{mso-style-priority:32;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	font-variant:small-caps;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	letter-spacing:.25pt;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:20.0pt;
	mso-bidi-font-size:20.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 2";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 4";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 5";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 6";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	font-style:italic;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 7";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 8";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	font-style:italic;}
span.Heading9Char
	{mso-style-name:"Heading 9 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 9";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Title;
	mso-ansi-font-size:28.0pt;
	mso-bidi-font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;}
span.SubtitleChar
	{mso-style-name:"Subtitle Char";
	mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Subtitle;
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	letter-spacing:.75pt;}
span.QuoteChar
	{mso-style-name:"Quote Char";
	mso-style-priority:29;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Quote;
	color:#404040;
	mso-themecolor:text1;
	mso-themetint:191;
	font-style:italic;}
span.IntenseQuoteChar
	{mso-style-name:"Intense Quote Char";
	mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Intense Quote";
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:Arial;
	mso-bidi-theme-font:minor-bidi;}
.MsoPapDefault
	{mso-style-type:export-only;
	margin-bottom:8.0pt;
	line-height:115%;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin-top:0cm;
	mso-para-margin-right:0cm;
	mso-para-margin-bottom:8.0pt;
	mso-para-margin-left:0cm;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:36.0pt;word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal>import React, <span class=GramE>{ <span class=SpellE>useState</span></span>,
<span class=SpellE>useMemo</span>, <span class=SpellE>useCallback</span>, <span
class=SpellE><span class=GramE>useEffect</span></span><span class=GramE> }</span>
from 'react<span class=GramE>';</span><o:p></o:p></p>

<p class=MsoNormal>import <span class=GramE>{ Layers</span>, Zap, <span
class=SpellE>TrendingUp</span>, <span class=SpellE>Cpu</span>, Users, Award, <span
class=SpellE>PlusCircle</span>, <span class=SpellE>LogIn</span>, <span
class=SpellE>CheckCircle</span>, Sparkles, <span class=SpellE><span
class=GramE>UserCheck</span></span><span class=GramE> }</span> from '<span
class=SpellE>lucide</span>-react<span class=GramE>';</span><o:p></o:p></p>

<p class=MsoNormal>import <span class=GramE>{ <span class=SpellE>initializeApp</span></span>
} from 'firebase/app<span class=GramE>';</span><o:p></o:p></p>

<p class=MsoNormal>import { <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>getAuth</span>, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>signInAnonymously</span>, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>signInWithCustomToken</span>, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onAuthStateChanged</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>setPersistence</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>browserLocalPersistence</span><o:p></o:p></p>

<p class=MsoNormal>} from 'firebase/auth<span class=GramE>';</span><o:p></o:p></p>

<p class=MsoNormal>import { <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>getFirestore</span>, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>collection, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>doc, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onSnapshot</span>, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>addDoc</span>, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>updateDoc</span>, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>deleteDoc</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>query,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>setDoc</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>setLogLevel</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>getDoc</span>, // Added for initial data check<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>getDocs</span> // Added for initial data check<o:p></o:p></p>

<p class=MsoNormal>} from 'firebase/<span class=SpellE>firestore</span><span
class=GramE>';</span> <o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>// --- CONFIGURATION AND INITIAL DATA ---<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>const LEAP_COLORS = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>BLUE<span
class=GramE>: '#</span>0078B5',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>RED<span
class=GramE>: '#</span>D82C2C',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>GREY<span
class=GramE>: '#4D4D4D',</span><o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>const PILLARS = [&quot;Product&quot;, &quot;Delivery&quot;,
&quot;Service&quot;, &quot;Relationship&quot;<span class=GramE>];</span><o:p></o:p></p>

<p class=MsoNormal>const TEAMS = [&quot;Team A&quot;, &quot;Team B&quot;,
&quot;Team C&quot;, &quot;Team D&quot;<span class=GramE>];</span><o:p></o:p></p>

<p class=MsoNormal>const LOW_SCORE_THRESHOLD = 3.5; // Threshold for triggering
the LLM suggestion<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>// Data models for seeding the database if it's empty<o:p></o:p></p>

<p class=MsoNormal>const <span class=SpellE>initialWeights</span> = <span
class=GramE>{ Product</span>: 0.20, Delivery: 0.25, Service: 0.25,
Relationship: <span class=GramE>0.30 }</span>;<o:p></o:p></p>

<p class=MsoNormal>const <span class=SpellE>initialScoresTemplate</span> = <span
class=SpellE>PILLARS.flatMap</span>(pillar =&gt; <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>['Communicate
value', 'Route feedback', 'Share roadmap', 'Pre-empt risks', 'Review SLAs',
'Close escalations', 'Own problems', 'Offer solutions', 'Acknowledge emotions',
'Map stakeholders', 'Hold QBRs', 'Co-create value']<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=GramE>.filter</span>((_,
<span class=SpellE>i</span>) =&gt; <span class=SpellE>PILLARS.indexOf</span>(pillar)
* 3 &lt;= <span class=SpellE>i</span> &amp;&amp; <span class=SpellE>i</span>
&lt; (<span class=SpellE>PILLARS.indexOf</span>(pillar) + 1) * 3)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=GramE>.map</span>(behavior
=<span class=GramE>&gt; ({</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>pillar,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>behavior</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Default to 3
for initial fill<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>score: 3, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}))<o:p></o:p></p>

<p class=MsoNormal><span class=GramE>).slice</span>(0, 12<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>const <span class=SpellE>initialTeamData</span> = (<span
class=SpellE>teamName</span>) =<span class=GramE>&gt; ({</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>teamName</span>: <span class=SpellE>teamName</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>evidenceFactor</span>: 1.0,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>behaviorScores</span>: <span class=SpellE><span class=GramE>initialScoresTemplate.map</span></span><span
class=GramE>(</span>item =&gt; ({...item, score: <span class=GramE>3})</span>),<o:p></o:p></p>

<p class=MsoNormal>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>// --- COMPONENTS ---<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>const <span class=SpellE>ScoreInput</span> = <span
class=GramE>({ score</span>, <span class=SpellE>onChange</span>, <span
class=GramE>disabled }</span>) =&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;select<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>value={score}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onChange</span><span class=GramE>={(</span>e) =&gt; <span
class=SpellE><span class=GramE>onChange</span></span><span class=GramE>(<span
class=SpellE>parseInt</span>(<span class=SpellE>e.target</span></span><span
class=SpellE>.value</span>, 10<span class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>className</span><span class=GramE>={</span>`w-16 p-1 text-center
border-2 rounded-lg cursor-pointer <span class=SpellE>bg</span>-white
text-gray-800 <span class=GramE>focus:ring</span>-4 transition ${<span
class=GramE>disabled ?</span> '<span class=GramE>opacity</span>-50
cursor-not-allowed bg-gray-100<span class=GramE>' :</span> '<span class=GramE>focus:ring</span>-blue-300<span
class=GramE>'}`</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>style<span
class=GramE>={{ <span class=SpellE>borderColor</span></span>: <span
class=GramE>disabled ?</span> '#ccc<span class=GramE>' :</span> LEAP_<span
class=GramE>COLORS.BLUE }</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>disabled={disabled}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{[1, 2, 3, 4, 5<span
class=GramE>].map</span>(<span class=SpellE>val</span> =&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;option key={<span
class=SpellE>val</span>} value={<span class=SpellE>val</span>}&gt;{<span
class=SpellE>val</span>}&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/select&gt;<o:p></o:p></p>

<p class=MsoNormal>);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>const <span class=SpellE>getRagClass</span> = (score) =&gt;
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (score &gt;= 80)
return &quot;bg-green-100 text-green-700 border-green-300<span class=GramE>&quot;;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (score &gt;= 60)
return &quot;bg-yellow-100 <span class=GramE>text-</span>yellow-700
border-yellow-300<span class=GramE>&quot;;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return
&quot;bg-red-100 <span class=GramE>text-</span>red-700 border-red-300<span
class=GramE>&quot;;</span><o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>const <span class=SpellE>ScoreBar</span> = <span
class=GramE>({ score</span>, <span class=GramE>rank }</span>) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>widthPercentage</span> = `${<span class=SpellE><span class=GramE>Math.min</span></span><span
class=GramE>(</span>100, score<span class=GramE>)}%`;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>ragClass</span> = <span class=SpellE>getRagClass</span>(score<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;flex items-center space-x-2 py-1&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span><span class=GramE>={</span>`w-8 h-8 rounded-full
flex items-center justify-center font-bold text-white shadow-md`} style<span
class=GramE>={{ <span class=SpellE>backgroundColor</span></span>: LEAP_<span
class=GramE>COLORS.BLUE }}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{rank}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;flex-grow bg-gray-200 rounded-full
h-3&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>className</span><span class=GramE>={</span>`h-3 rounded-full
transition-all duration-700 ease-out shadow-inner ${<span class=SpellE>ragClass.replace</span>('<span
class=SpellE>bg</span>-', '<span class=SpellE>bg</span>-'<span class=GramE>)}`</span>}
<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>style<span
class=GramE>={{ width</span>: <span class=SpellE>widthPercentage</span>, <span
class=SpellE>backgroundColor</span>: <span class=SpellE>ragClass.includes</span>('green'<span
class=GramE>) ?</span> '#10B981<span class=GramE>' :</span> <span class=SpellE>ragClass.includes</span>('yellow'<span
class=GramE>) ?</span> '#F59E0B<span class=GramE>' :</span> <span class=GramE>LEAP_COLORS.RED
}</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;span <span
class=SpellE>className</span><span class=GramE>={</span>`w-12 text-center
font-bold text-lg p-1 rounded-lg border ${<span class=SpellE>ragClass</span>}`}&gt;{score}&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>const <span class=SpellE>LedgerRow</span> = <span
class=GramE>({ item</span>, <span class=SpellE>onEdit</span>, <span
class=SpellE>onDelete</span>, <span class=SpellE><span class=GramE>isTrainer</span></span><span
class=GramE> }</span>) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const fields =
['area', 'action', 'owner', '<span class=SpellE>kpi</span>', 'timeline',
'proof'<span class=GramE>];</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;tr <span
class=SpellE>className</span>=&quot;hover:bg-blue-50 transition&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>{<span class=SpellE>fields.map</span>((</span>field) =&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
key={field} <span class=SpellE>className</span>=&quot;px-4 py-3 text-<span
class=SpellE>sm</span> text-gray-700&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;input<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>type=&quot;text&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>value={item[<span class=GramE>field]}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onChange</span><span class=GramE>={(</span>e) =&gt; <span
class=SpellE><span class=GramE>onEdit</span></span><span class=GramE>(</span>item.id,
field, <span class=SpellE><span class=GramE>e.target</span>.<span class=GramE>value</span></span><span
class=GramE>)}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>className</span>=&quot;w-full p-1 border-b border-gray-300 <span
class=GramE>focus:border</span>-blue-500 <span class=SpellE>bg</span>-transparent
text-<span class=SpellE>sm</span>&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>/&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td <span
class=SpellE>className</span>=&quot;px-4 py-3 text-<span class=SpellE>sm</span>
text-center&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onClick</span><span class=GramE>={</span>() =&gt; <span
class=SpellE>onDelete</span>(item.id)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>className</span>=&quot;text-red-600 hover:text-red-800 transition
p-1 rounded-full hover:<span class=GramE>bg-</span>red-100&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>title=&quot;Delete Commitment&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&amp;<span
class=GramE>times;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>// --- TEAM SELECTION MODAL ---<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>const <span class=SpellE>TeamSelectionModal</span> = <span
class=GramE>({ teams</span>, <span class=SpellE><span class=GramE>onSelect</span></span><span
class=GramE> }</span>) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [<span
class=SpellE>selectedTeam</span>, <span class=SpellE>setSelectedTeam</span>] = <span
class=SpellE>useState</span>(<span class=GramE>teams[</span>0]<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;fixed inset-0 bg-gray-900 bg-opacity-75
flex items-center justify-center z-50 p-4&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;<span class=SpellE>bg</span>-white
rounded-2xl shadow-2xl p-8 max-w-md w-full text-center&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>LogIn</span> <span class=SpellE>className</span>=&quot;h-10 w-10
mx-auto mb-4&quot; style<span class=GramE>={{ color</span>: LEAP_<span
class=GramE>COLORS.BLUE }</span>} /&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h2
<span class=SpellE>className</span>=&quot;text-2xl font-bold mb-3&quot; style<span
class=GramE>={{ color</span>: LEAP_<span class=GramE>COLORS.BLUE }}&gt;</span>Welcome
to the <span class=GramE>Scoreboard!&lt;</span>/h2&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;p <span
class=SpellE>className</span>=&quot;text-gray-700 mb-6&quot;&gt;Select your
team or role to <span class=GramE>begin.&lt;</span>/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div <span class=SpellE>className</span>=&quot;mb-4&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;select<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>value={<span class=SpellE>selectedTeam</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span><span class=SpellE>onChange</span><span class=GramE>={(</span>e) =&gt; <span
class=SpellE>setSelectedTeam</span>(<span class=SpellE><span class=GramE>e.target</span>.<span
class=GramE>value</span></span><span class=GramE>)}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span><span class=SpellE>className</span>=&quot;w-full p-3 border-2 rounded-lg
text-lg <span class=GramE>focus:ring</span>-4 transition&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>style<span class=GramE>={{ <span class=SpellE>borderColor</span></span>:
LEAP_<span class=GramE>COLORS.BLUE }</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>{<span class=SpellE><span class=GramE>teams.map</span></span><span
class=GramE>(</span>team =&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;option key={team} value={team}&gt;{team}&lt;/option&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span><span class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/select&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;button<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onClick</span><span class=GramE>={</span>() =&gt; <span
class=SpellE>onSelect</span>(<span class=SpellE><span class=GramE>selectedTeam</span></span><span
class=GramE>)}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>className</span>=&quot;w-full py-3 text-lg font-semibold
rounded-lg text-white transition duration-300 shadow-md <span class=SpellE><span
class=GramE>hover:shadow</span>-lg</span> mb-4&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>style<span class=GramE>={{ <span class=SpellE>backgroundColor</span></span>:
LEAP_<span class=GramE>COLORS.BLUE }</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>CheckCircle</span> <span class=SpellE>className</span>=&quot;inline
h-5 w-5 mr-2 mb-1&quot; /&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>Claim and <span class=GramE>Enter</span> as {<span class=SpellE>selectedTeam</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div <span class=SpellE>className</span>=&quot;border-t
pt-4&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;button<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span><span class=SpellE>onClick</span><span class=GramE>={</span>() =&gt; <span
class=SpellE>onSelect</span>('Trainer<span class=GramE>')}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span><span class=SpellE>className</span>=&quot;w-full py-2 text-md
font-semibold rounded-lg transition duration-300 text-gray-700 border-2
border-gray-300 hover:bg-gray-100&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>UserCheck</span> <span class=SpellE>className</span>=&quot;inline
h-5 w-5 mr-2 mb-1&quot; /&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>Login as Trainer (Read-Only)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>// --- CORE APPLICATION COMPONENT ---<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>const App = () =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [<span
class=SpellE>activeTab</span>, <span class=SpellE>setActiveTab</span>] = <span
class=SpellE>useState</span>('Leaderboard'<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [weights, <span
class=SpellE>setWeights</span>] = <span class=SpellE>useState</span>(<span
class=SpellE>initialWeights</span><span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [<span
class=SpellE>allTeamData</span>, <span class=SpellE>setAllTeamData</span>] = <span
class=SpellE><span class=GramE>useState</span></span><span class=GramE>(</span>{});
// <span class=GramE>{ '</span>Team A<span class=GramE>': {</span><span
class=SpellE>behaviorScores</span>: [], <span class=SpellE>evidenceFactor</span>:
<span class=GramE>1.0},</span> <span class=GramE>... }</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [<span
class=SpellE>ledgerItems</span>, <span class=SpellE>setLedgerItems</span>] = <span
class=SpellE><span class=GramE>useState</span></span><span class=GramE>(</span>[]<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// State for LLM
interaction<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [<span
class=SpellE>llmStatus</span>, <span class=SpellE>setLlmStatus</span>] = <span
class=SpellE><span class=GramE>useState</span></span><span class=GramE>(</span>{
<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>isLoading</span>: false, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>error: null, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>message: null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>targetPillar</span>: null<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Firebase and Auth
States<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [<span
class=SpellE>db</span>, <span class=SpellE>setDb</span>] = <span class=SpellE>useState</span>(null<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [auth, <span
class=SpellE>setAuth</span>] = <span class=SpellE>useState</span>(null<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [<span
class=SpellE>userId</span>, <span class=SpellE>setUserId</span>] = <span
class=SpellE>useState</span>(null<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [<span
class=SpellE>isAuthReady</span>, <span class=SpellE>setIsAuthReady</span>] = <span
class=SpellE>useState</span>(false<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const [<span
class=SpellE>userRole</span>, <span class=SpellE>setUserRole</span>] = <span
class=SpellE>useState</span>(null); // 'Trainer' or 'Team A', 'Team B', etc.<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// ---
Environment/Global Variable Access ---<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>appId</span> = <span class=SpellE><span class=GramE>typeof</span></span>
__<span class=SpellE>app_<span class=GramE>id</span></span><span class=GramE> !</span>==
'undefined<span class=GramE>' ?</span> __<span class=SpellE>app_<span
class=GramE>id</span></span><span class=GramE> :</span> 'default-app-id<span
class=GramE>';</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>firebaseConfig</span> = <span class=SpellE>typeof</span> __<span
class=SpellE>firebase_<span class=GramE>config</span></span><span class=GramE>
!</span>== 'undefined<span class=GramE>' ?</span> <span class=SpellE>JSON.parse</span>(__<span
class=SpellE>firebase_config</span><span class=GramE>) :</span> <span
class=GramE>null;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>initialAuthToken</span> = <span class=SpellE><span class=GramE>typeof</span></span>
__<span class=SpellE>initial_auth_<span class=GramE>token</span></span><span
class=GramE> !</span>== 'undefined<span class=GramE>' ?</span> __<span
class=SpellE>initial_auth_<span class=GramE>token</span></span><span
class=GramE> :</span> <span class=GramE>null;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>//
------------------------------------------<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>isTrainer</span> = <span class=SpellE>userRole</span> === 'Trainer<span
class=GramE>';</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>userTeam</span> = <span class=SpellE><span class=GramE>isTrainer</span></span><span
class=GramE> ?</span> <span class=GramE>null :</span> <span class=SpellE>userRole</span>;
// Null if Trainer<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>currentTeamData</span> = <span class=SpellE>allTeamData</span>[<span
class=SpellE>userTeam</span>] || <span class=GramE>{ <span class=SpellE>behaviorScores</span></span>:
<span class=SpellE>initialScoresTemplate</span>, <span class=SpellE>evidenceFactor</span>:
<span class=GramE>1.0 }</span>;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// --- FIREBASE
INITIALIZATION &amp; AUTH ---<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=SpellE><span
class=GramE>useEffect</span></span><span class=GramE>(</span>() =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Check if config
exists before proceeding<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>firebaseConfig</span></span>) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>('Firebase config is
missing.'<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>return;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>setLogLevel</span>('debug'<span class=GramE>);</span> <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const app = <span
class=SpellE>initializeApp</span>(<span class=SpellE>firebaseConfig</span><span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>firestore</span> = <span class=SpellE>getFirestore</span>(app<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>authInstance</span> = <span class=SpellE>getAuth</span>(app<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Use browser
persistence<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>setPersistence</span></span><span class=GramE>(</span><span
class=SpellE>authInstance</span>, <span class=SpellE>browserLocalPersistence</span><span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>setDb</span>(<span class=SpellE>firestore</span><span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>setAuth</span>(<span class=SpellE>authInstance</span><span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>onAuthStateChanged</span></span><span
class=GramE>(</span><span class=SpellE>authInstance</span>, async (user) =&gt;
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let <span
class=SpellE>currentUid</span> = <span class=GramE>null;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (user) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>currentUid</span> = <span class=SpellE><span class=GramE>user.uid</span></span><span
class=GramE>;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} else if (<span
class=SpellE>initialAuthToken</span>) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
credential = await <span class=SpellE><span class=GramE>signInWithCustomToken</span></span><span
class=GramE>(</span><span class=SpellE>authInstance</span>, <span class=SpellE>initialAuthToken</span><span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>currentUid</span> = <span class=SpellE><span class=GramE>credential.user.uid</span></span><span
class=GramE>;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>e) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Custom token
sign in failed, falling back:&quot;, e<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>anonCredential</span> = await <span class=SpellE>signInAnonymously</span>(<span
class=SpellE>authInstance</span><span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>currentUid</span> = <span class=SpellE><span class=GramE>anonCredential.user.uid</span></span><span
class=GramE>;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// No
token, sign in anonymously<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>anonCredential</span> = await <span class=SpellE>signInAnonymously</span>(<span
class=SpellE>authInstance</span><span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>currentUid</span> = <span class=SpellE><span class=GramE>anonCredential.user.uid</span></span><span
class=GramE>;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>setUserId</span></span><span class=GramE>(</span><span
class=SpellE>currentUid</span> || <span class=SpellE><span class=GramE>crypto.randomUUID</span></span>()<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>setIsAuthReady</span>(true<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>error) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Firebase
initialization failed:&quot;, error<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, []);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// --- INITIAL DATA
SEEDING (Runs once after auth is ready) ---<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// This is separated
to avoid internal <span class=SpellE>Firestore</span> assertion errors by
ensuring docs exist before listeners start.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=SpellE><span
class=GramE>useEffect</span></span><span class=GramE>(</span>() =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>db</span></span> |<span class=GramE>| !<span
class=SpellE>isAuthReady</span></span> |<span class=GramE>| !<span
class=SpellE>userId</span></span>) <span class=GramE>return;</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
PUBLIC_DATA_PATH = `/artifacts/${<span class=SpellE>appId</span>}/public/data<span
class=GramE>`;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>configRef</span> = <span class=GramE>doc(</span><span
class=SpellE>db</span>, `${PUBLIC_DATA_<span class=GramE>PATH}/</span><span
class=SpellE>scoreboard_config</span>`, 'weights'<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamCollectionRef</span> = <span class=GramE>collection(</span><span
class=SpellE>db</span>, `${PUBLIC_DATA_<span class=GramE>PATH}/</span><span
class=SpellE>team_inputs</span>`<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>seedData</span> = async () =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>console.log(</span>&quot;Checking for initial data and seeding if
necessary...&quot;<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Check
and seed weights<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>weightSnap</span> = await <span class=SpellE>getDoc</span>(<span
class=SpellE>configRef</span><span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>weightSnap.exists</span></span>()) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await <span
class=SpellE><span class=GramE>setDoc</span></span><span class=GramE>(</span><span
class=SpellE>configRef</span>, <span class=GramE>{ weights</span>: <span
class=SpellE><span class=GramE>initialWeights</span></span><span class=GramE>
});</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>console.log(</span>&quot;Weights document created.&quot;<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Check
and seed team inputs<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamSnap</span> = await <span class=SpellE>getDocs</span>(<span
class=SpellE>teamCollectionRef</span><span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (<span
class=SpellE>teamSnap.empty</span>) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>console.log(</span>&quot;Team input collection is empty. Seeding
initial teams...&quot;<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>//
Note: using <span class=SpellE>Promise.all</span> to ensure all writes complete<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await <span
class=SpellE><span class=GramE>Promise.all</span></span><span class=GramE>(<span
class=SpellE>TEAMS.map</span>(</span>team =&gt; <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>setDoc</span></span><span class=GramE>(doc(</span><span
class=SpellE>teamCollectionRef</span>, team), <span class=SpellE>initialTeamData</span>(team))<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>));<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>console.log(</span>&quot;Initial team inputs seeded.&quot;<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>e) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Error during
initial data seeding:&quot;, e<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>seedData</span></span><span class=GramE>();</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, [<span
class=SpellE>db</span>, <span class=SpellE>isAuthReady</span>, <span
class=SpellE>appId</span>, <span class=SpellE>userId</span>]<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// --- DATA
SYNCHRONIZATION (<span class=SpellE>onSnapshot</span>) ---<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=SpellE><span
class=GramE>useEffect</span></span><span class=GramE>(</span>() =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// CRITICAL: Only
attach listeners after Auth is ready and <span class=SpellE>userId</span> is
set.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>db</span></span> |<span class=GramE>| !<span
class=SpellE>isAuthReady</span></span> |<span class=GramE>| !<span
class=SpellE>userId</span></span>) <span class=GramE>return;</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
PUBLIC_DATA_PATH = `/artifacts/${<span class=SpellE>appId</span>}/public/data<span
class=GramE>`;</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// 1. Subscribe to
Weights<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>configRef</span> = <span class=GramE>doc(</span><span
class=SpellE>db</span>, `${PUBLIC_DATA_<span class=GramE>PATH}/</span><span
class=SpellE>scoreboard_config</span>`, 'weights'<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>unsubscribeWeights</span> = <span class=SpellE><span class=GramE>onSnapshot</span></span><span
class=GramE>(</span><span class=SpellE>configRef</span>, (<span class=SpellE>docSnap</span>)
=&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (<span
class=SpellE>docSnap.exists</span>()) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>setWeights</span></span><span class=GramE>(</span><span
class=SpellE>docSnap.data</span>(<span class=GramE>).weights);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, (e) =&gt; <span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Weights
subscription failed:&quot;, e)<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// 2. Subscribe to
All Team Data (Scores &amp; Evidence Factor)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamCollectionRef</span> = <span class=GramE>collection(</span><span
class=SpellE>db</span>, `${PUBLIC_DATA_<span class=GramE>PATH}/</span><span
class=SpellE>team_inputs</span>`<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>unsubscribeTeams</span> = <span class=SpellE><span class=GramE>onSnapshot</span></span><span
class=GramE>(</span><span class=SpellE>teamCollectionRef</span>, (snapshot)
=&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamDataMap</span> = {<span class=GramE>};</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>snapshot.docs</span>.<span class=GramE>forEach</span></span><span
class=GramE>(</span>doc =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>teamDataMap</span>[doc.id] = <span class=SpellE>doc.<span
class=GramE>data</span></span><span class=GramE>();</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>setAllTeamData</span>(<span class=SpellE>teamDataMap</span><span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, (e) =&gt; <span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Teams
subscription failed:&quot;, e)<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// 3. Subscribe to
Alliance Ledger<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>ledgerCollectionRef</span> = <span class=GramE>collection(</span><span
class=SpellE>db</span>, `${PUBLIC_DATA_<span class=GramE>PATH}/</span><span
class=SpellE>alliance_ledger</span>`<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>unsubscribeLedger</span> = <span class=SpellE><span class=GramE>onSnapshot</span></span><span
class=GramE>(</span><span class=SpellE>ledgerCollectionRef</span>, (snapshot)
=&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const items = <span
class=SpellE><span class=GramE>snapshot.docs.map</span></span><span
class=GramE>(</span>doc =&gt; <span class=GramE>({ id</span>: doc.id, ...<span
class=SpellE>doc.<span class=GramE>data</span></span><span class=GramE>() }</span>)<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>setLedgerItems</span></span><span class=GramE>(<span
class=SpellE>items.sort</span></span>((a, b) =&gt; (a.id &gt; b.id<span
class=GramE>) ?</span> <span class=GramE>1 :</span> -1)<span class=GramE>);</span>
<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, (e) =&gt; <span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Ledger
subscription failed:&quot;, e)<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// 4. Check user's
claimed role (Private Data)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Path: /<span
class=GramE>artifacts/{<span class=SpellE>appId</span>}/users/{<span
class=SpellE>userId</span>}/</span><span class=SpellE>user_settings</span>/<span
class=SpellE>role_claim</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>userRoleRef</span> = <span class=GramE>doc(</span><span
class=SpellE>db</span>, `/artifacts/${<span class=SpellE>appId</span>}/users/${<span
class=SpellE>userId</span>}/<span class=SpellE>user_settings</span>`, '<span
class=SpellE>role_claim</span>'<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>unsubscribeUserRole</span> = <span class=SpellE><span class=GramE>onSnapshot</span></span><span
class=GramE>(</span><span class=SpellE>userRoleRef</span>, (<span class=SpellE>docSnap</span>)
=&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if (<span
class=SpellE>docSnap.exists</span>() &amp;&amp; <span class=SpellE>docSnap.data</span>(<span
class=GramE>).<span class=SpellE>roleName</span></span>) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>setUserRole</span></span><span class=GramE>(</span><span
class=SpellE>docSnap.data</span>(<span class=GramE>).<span class=SpellE>roleName</span>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, (e) =&gt; <span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Role claim
subscription failed:&quot;, e)<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return () =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Cleanup all
listeners to prevent memory leaks and assertion errors<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>unsubscribeWeights</span></span><span
class=GramE>();</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>unsubscribeTeams</span></span><span class=GramE>();</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>unsubscribeLedger</span></span><span
class=GramE>();</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>unsubscribeUserRole</span></span><span
class=GramE>();</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, [<span
class=SpellE>db</span>, <span class=SpellE>isAuthReady</span>, <span
class=SpellE>appId</span>, <span class=SpellE>userId</span>]<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// --- FIRESTORE
WRITE OPERATIONS ---<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Handle team or
role claim from modal<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>handleRoleClaim</span> = async (<span class=SpellE>roleName</span>)
=&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>db</span></span> |<span class=GramE>| !<span
class=SpellE>userId</span></span>) <span class=GramE>return;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Store the
claim in the user's private data space.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>userRoleRef</span> = <span class=GramE>doc(</span><span
class=SpellE>db</span>, `/artifacts/${<span class=SpellE>appId</span>}/users/${<span
class=SpellE>userId</span>}/<span class=SpellE>user_settings</span>`, '<span
class=SpellE>role_claim</span>'<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await <span
class=SpellE><span class=GramE>setDoc</span></span><span class=GramE>(</span><span
class=SpellE>userRoleRef</span>, <span class=GramE>{ <span class=SpellE>roleName</span></span>:
<span class=SpellE>roleName</span>, <span class=SpellE>claimedAt</span>: new
Date(<span class=GramE>).<span class=SpellE>toISOString</span></span>(<span
class=GramE>) });</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>setUserRole</span>(<span class=SpellE>roleName</span><span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>e) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Error claiming
role:&quot;, e<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Function to
update behavior score in <span class=SpellE>Firestore</span> (Only for current
user's team)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>handleScoreChange</span> = <span class=SpellE><span class=GramE>useCallback</span></span><span
class=GramE>(</span>async (team, index, <span class=SpellE>newScore</span>)
=&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>db</span></span> || <span class=GramE>team !</span>==
<span class=SpellE>userTeam</span>) <span class=GramE>return;</span> <o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamRef</span> = <span class=GramE>doc(</span><span class=SpellE>db</span>,
`/artifacts/${<span class=SpellE>appId</span>}/public/data/<span class=SpellE>team_inputs</span>`,
team<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamData</span> = <span class=SpellE>allTeamData</span>[team<span
class=GramE>];</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>updatedScores</span> = <span class=SpellE><span class=GramE>teamData.behaviorScores.map</span></span><span
class=GramE>(</span>(item, <span class=SpellE>i</span>) =&gt; <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>i</span></span><span class=GramE> =</span>== <span
class=GramE>index ?</span> <span class=GramE>{ ...</span>item, score: <span
class=SpellE><span class=GramE>newScore</span></span><span class=GramE> }</span>
: item<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await <span
class=SpellE><span class=GramE>setDoc</span></span><span class=GramE>(<span
class=SpellE>teamRef</span>, {</span> <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>...<span
class=SpellE>teamData</span>, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>behaviorScores</span>: <span class=SpellE>updatedScores</span> <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>e) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Error updating
score:&quot;, e<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, [<span
class=SpellE>db</span>, <span class=SpellE>userTeam</span>, <span class=SpellE>allTeamData</span>,
<span class=SpellE>appId</span>]<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Function to
update pillar weights in <span class=SpellE>Firestore</span> (Trainer cannot
edit)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>handleWeightChange</span> = <span class=SpellE><span class=GramE>useCallback</span></span><span
class=GramE>(</span>async (pillar, <span class=SpellE>newWeight</span>) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>db</span></span> || <span class=SpellE>isTrainer</span>)
<span class=GramE>return;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>configRef</span> = <span class=GramE>doc(</span><span
class=SpellE>db</span>, `/artifacts/${<span class=SpellE>appId</span>}/public/data/<span
class=SpellE>scoreboard_config</span>`, 'weights'<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>newWeights</span> = <span class=GramE>{ ...</span>weights,
[pillar]: <span class=SpellE><span class=GramE>newWeight</span></span><span
class=GramE> }</span>;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await <span
class=SpellE><span class=GramE>setDoc</span></span><span class=GramE>(</span><span
class=SpellE>configRef</span>, <span class=GramE>{ weights</span>: <span
class=SpellE><span class=GramE>newWeights</span></span><span class=GramE> });</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>e) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Error updating
weights:&quot;, e<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, [<span
class=SpellE>db</span>, weights, <span class=SpellE>appId</span>, <span
class=SpellE>isTrainer</span>]<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Function to
update evidence factor in <span class=SpellE>Firestore</span> (Trainer cannot
edit)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>handleEvidenceFactorChange</span> = <span class=SpellE><span
class=GramE>useCallback</span></span><span class=GramE>(</span>async (team, <span
class=SpellE>newFactor</span>) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>db</span></span> || <span class=GramE>team !</span>==
<span class=SpellE>userTeam</span> || <span class=SpellE>isTrainer</span>) <span
class=GramE>return;</span> <o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamRef</span> = <span class=GramE>doc(</span><span class=SpellE>db</span>,
`/artifacts/${<span class=SpellE>appId</span>}/public/data/<span class=SpellE>team_inputs</span>`,
team<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamData</span> = <span class=SpellE>allTeamData</span>[team<span
class=GramE>];</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await <span
class=SpellE><span class=GramE>setDoc</span></span><span class=GramE>(<span
class=SpellE>teamRef</span>, {</span> <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>...<span
class=SpellE>teamData</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>evidenceFactor</span>: <span class=SpellE>parseFloat</span>(<span
class=SpellE>newFactor</span>) || 0<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, <span
class=GramE>{ merge</span>: <span class=GramE>true });</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>e) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Error updating
evidence factor:&quot;, e<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, [<span
class=SpellE>db</span>, <span class=SpellE>userTeam</span>, <span class=SpellE>allTeamData</span>,
<span class=SpellE>appId</span>, <span class=SpellE>isTrainer</span>]<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// --- Ledger
Handlers (Public Collection - Editable by Teams &amp; Trainer) ---<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>handleLedgerEdit</span> = <span class=SpellE><span class=GramE>useCallback</span></span><span
class=GramE>(</span>async (id, field, value) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>db</span></span>) <span class=GramE>return;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>itemRef</span> = <span class=GramE>doc(</span><span class=SpellE>db</span>,
`/artifacts/${<span class=SpellE>appId</span>}/public/data/<span class=SpellE>alliance_ledger</span>`,
id<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await <span
class=SpellE><span class=GramE>setDoc</span></span><span class=GramE>(</span><span
class=SpellE>itemRef</span>, <span class=GramE>{ [field]:</span> <span
class=GramE>value }</span>, <span class=GramE>{ merge</span>: <span
class=GramE>true });</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>e) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Error updating
ledger item:&quot;, e<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, [<span
class=SpellE>db</span>, <span class=SpellE>appId</span>]<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>handleLedgerAdd</span> = <span class=SpellE><span class=GramE>useCallback</span></span><span
class=GramE>(</span>async () =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>db</span></span>) <span class=GramE>return;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>newCommitment</span> = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>area: 'New',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>action: 'Enter
commitment here',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>owner: <span
class=SpellE>userRole</span> || <span class=SpellE>userId</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>kpi</span>: 'Define success metric',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>timeline:
'MM/YYYY',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>proof: '</span>',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await <span
class=SpellE><span class=GramE>addDoc</span></span><span class=GramE>(collection(</span><span
class=SpellE>db</span>, `/artifacts/${<span class=SpellE>appId</span>}/public/data/<span
class=SpellE>alliance_ledger</span>`), <span class=SpellE>newCommitment</span><span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>e) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Error adding
ledger item:&quot;, e<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, [<span
class=SpellE>db</span>, <span class=SpellE>userRole</span>, <span class=SpellE>userId</span>,
<span class=SpellE>appId</span>]<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>handleLedgerDelete</span> = <span class=SpellE><span class=GramE>useCallback</span></span><span
class=GramE>(</span>async (id) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>db</span></span>) <span class=GramE>return;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await <span
class=SpellE><span class=GramE>deleteDoc</span></span><span class=GramE>(doc(</span><span
class=SpellE>db</span>, `/artifacts/${<span class=SpellE>appId</span>}/public/data/<span
class=SpellE>alliance_ledger</span>`, id)<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>e) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(&quot;Error deleting
ledger item:&quot;, e<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, [<span
class=SpellE>db</span>, <span class=SpellE>appId</span>]<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// --- End Ledger
Handlers ---<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// --- Core
Calculation Logic (Replicating Leaderboard formulas) ---<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=GramE>{ leaderboard</span>, <span class=SpellE><span class=GramE>teamPillarAverages</span></span><span
class=GramE> }</span> = <span class=SpellE><span class=GramE>useMemo</span></span><span
class=GramE>(</span>() =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamScores</span> = {<span class=GramE>};</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamRadarData</span> = {<span class=GramE>};</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>allTeams</span> = <span class=SpellE>Object.keys</span>(<span
class=SpellE>allTeamData</span><span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// 1. Calculate
Radar Data (Pillar Averages)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>allTeams.forEach</span>(team =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>teamData</span> = <span class=SpellE>allTeamData</span>[team<span
class=GramE>];</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>teamRadarData</span>[team] = {<span class=GramE>};</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>PILLARS.forEach</span>(pillar =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>pillarScores</span> = <span class=SpellE>teamData.behaviorScores</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>.filter</span>(item =&gt; <span class=SpellE><span class=GramE>item.pillar</span></span>
=== pillar)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>.map</span>(item =&gt; <span class=SpellE><span class=GramE>item.score</span></span><span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
average = <span class=SpellE>pillarScores.length</span> &gt; 0<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>? <span
class=SpellE>pillarScores.<span class=GramE>reduce</span></span><span
class=GramE>((</span>sum, score) =&gt; sum + score, 0) / <span class=SpellE>pillarScores.length</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>: <span
class=GramE>0;</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>teamRadarData</span>[team][pillar] = <span class=GramE>average;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// 2. Calculate
Account Health (SUMPRODUCT equivalent)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>allTeams.forEach</span>(team =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>let <span
class=SpellE>sumproduct</span> = <span class=GramE>0;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>PILLARS.forEach</span>(pillar =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// <span
class=GramE>SUMPRODUCT(<span class=SpellE>Settings!Weights</span></span>, <span
class=SpellE>Radar_<span class=GramE>Data!Averages</span></span>)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>sumproduct</span> += weights[pillar] * (<span class=SpellE>teamRadarData</span>[team][pillar]
|| 0<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Final
Account Health Score (<span class=GramE>ROUND(</span>20 * SUMPRODUCT * <span
class=SpellE>EvidenceFactor</span>, 0))<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const score = <span
class=SpellE>Math.round</span>(20 * <span class=SpellE>sumproduct</span> * (<span
class=SpellE>allTeamData</span>[team<span class=GramE>].<span class=SpellE>evidenceFactor</span></span>
|| 1.0)<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>teamScores</span>[team] = <span class=GramE>score;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// 3. Calculate
Rank (RANK.EQ equivalent)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>scoresArray</span> = <span class=SpellE>Object.entries</span>(<span
class=SpellE>teamScores</span>)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>.map(([</span>team, score]) =&gt; <span class=GramE>({ team</span>,
<span class=GramE>score }</span>)<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>sortedScores</span> = [...<span class=SpellE>scoresArray</span><span
class=GramE>].sort</span>((a, b) =&gt; <span class=SpellE><span class=GramE>b.score</span></span>
- <span class=SpellE><span class=GramE>a.score</span></span><span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const leaderboard
= <span class=SpellE><span class=GramE>scoresArray.map</span></span><span
class=GramE>(</span>item =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const rank = <span
class=SpellE>sortedScores.findIndex</span>(s =&gt; <span class=SpellE><span
class=GramE>s.score</span></span> === <span class=SpellE><span class=GramE>item.score</span></span>)
+ <span class=GramE>1;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>team: <span
class=SpellE><span class=GramE>item.team</span></span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>score: <span
class=SpellE><span class=GramE>item.score</span></span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>evidenceFactor</span>: <span class=SpellE>allTeamData</span>[<span
class=SpellE><span class=GramE>item.team</span></span><span class=GramE>].<span
class=SpellE>evidenceFactor</span></span> || 1.0,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>rank: rank,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>radar: <span
class=SpellE>teamRadarData</span>[<span class=SpellE><span class=GramE>item.team</span></span>],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return <span
class=GramE>{ leaderboard</span>, <span class=SpellE>teamPillarAverages</span>:
<span class=SpellE><span class=GramE>teamRadarData</span></span><span
class=GramE> }</span>;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, [weights, <span
class=SpellE>allTeamData</span>]<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Current user's
pillar averages for the LLM feature<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>currentUserPillarAverages</span> = <span class=SpellE>teamPillarAverages</span>[<span
class=SpellE>userTeam</span>] || {<span class=GramE>};</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// --- GEMINI API
INTEGRATION: ACTION PLAN GENERATOR ---<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>generateActionPlan</span> = <span class=SpellE><span class=GramE>useCallback</span></span><span
class=GramE>(</span>async (pillar, <span class=SpellE>teamScores</span>) =&gt;
{<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>db</span></span> |<span class=GramE>| !<span
class=SpellE>userTeam</span></span> || <span class=SpellE>llmStatus.isLoading</span>)
<span class=GramE>return;</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>setLlmStatus</span></span><span class=GramE>({ <span
class=SpellE>isLoading</span></span>: true, error: null, message: null, <span
class=SpellE>targetPillar</span>: <span class=GramE>pillar });</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
GEMINI_API_URL = `<span class=GramE>https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=`;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>apiKey</span> = &quot;<span class=GramE>&quot;;</span> <o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>scoresList</span> = <span class=SpellE>teamScores</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>.filter</span>(item =&gt; <span class=SpellE><span class=GramE>item.pillar</span></span>
=== pillar)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>.map</span>(item =&gt; `Behavior: &quot;${<span class=SpellE><span
class=GramE>item.behavior</span></span>}&quot; Score: ${<span class=SpellE><span
class=GramE>item.score</span></span>}/5`)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>.join</span>('\n'<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>systemPrompt</span> = `You are a highly analytical Strategic
Performance Coach specializing in alliance management. Your goal is to analyze
a team's behavior scores in a specific pillar and generate a concise,
actionable improvement plan. The plan MUST be formatted as a JSON array of
specific <span class=GramE>actions.`</span>;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>userQuery</span> = `Analyze the following behavior scores for the
&quot;${pillar}&quot; pillar for ${<span class=SpellE>userTeam</span>}. The
maximum score is 5.<o:p></o:p></p>

<p class=MsoNormal>Scores:<o:p></o:p></p>

<p class=MsoNormal>${<span class=SpellE>scoresList</span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Based on these low scores (average below ${LOW_SCORE_<span
class=GramE>THRESHOLD})</span>, provide a summary of the root cause and a
3-point action plan. Each action must be a simple, concrete task suitable for a
30-day commitment, focusing on the lowest scoring <span class=GramE>behaviors.`</span>;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const payload = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>contents: <span
class=GramE>[{ parts</span>: <span class=GramE>[{ text</span>: <span
class=SpellE><span class=GramE>userQuery</span></span><span class=GramE> }</span>]
}],<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>systemInstruction</span>: <span class=GramE>{ parts</span>: <span
class=GramE>[{ text</span>: <span class=SpellE><span class=GramE>systemPrompt</span></span><span
class=GramE> }</span>] },<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>generationConfig</span></span><span class=GramE>:
{</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>responseMimeType</span>: &quot;application/<span class=SpellE>json</span>&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>responseSchema</span></span><span class=GramE>:
{</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>type:
&quot;OBJECT&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>properties: {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>summary: <span class=GramE>{ type</span>: &quot;STRING&quot;,
description: &quot;A brief, professional summary of the core issue identified.<span
class=GramE>&quot; }</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>actions: {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>type: &quot;ARRAY&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>description: &quot;3 concrete, short-term actions to improve scores in
this pillar.&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span><span class=GramE>items: {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>type: &quot;OBJECT&quot;,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span><span class=GramE>properties: {</span><o:p></o:p></p>

<p class=MsoNormal><span
style='mso-spacerun:yes'> </span>action: <span
class=GramE>{ type</span>: &quot;STRING&quot;, description: &quot;The specific
task, e.g., 'Draft and socialize QBR agenda template.'<span class=GramE>&quot;
}</span>,<o:p></o:p></p>

<p class=MsoNormal><span
style='mso-spacerun:yes'> </span><span
class=SpellE>kpi</span>: <span class=GramE>{ type</span>: &quot;STRING&quot;,
description: &quot;The success metric, e.g., 'Template approved by management.'<span
class=GramE>&quot; }</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=GramE>let
attempts</span> = <span class=GramE>0;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>maxRetries</span> = <span class=GramE>3;</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>while (attempts
&lt; <span class=SpellE><span class=GramE>maxRetries</span></span><span
class=GramE>) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>attempts+<span
class=GramE>+;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>try {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
response = await <span class=GramE>fetch(</span>GEMINI_API_<span class=GramE>URL,
{</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>method: 'POST',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>headers: <span class=GramE>{ '</span>Content-Type': 'application/<span
class=SpellE>json</span><span class=GramE>' }</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>body: <span
class=SpellE>JSON.stringify</span>(payload)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>response</span></span><span class=SpellE>.<span
class=GramE>ok</span></span><span class=GramE>) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>//
Throw <span class=GramE>error</span> to trigger retry logic<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>throw
new <span class=GramE>Error(</span>`HTTP error! status: ${<span class=SpellE><span
class=GramE>response.status</span></span>}`<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
result = await <span class=SpellE><span class=GramE>response.json</span></span>(<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>textJson</span> = <span class=SpellE><span class=GramE>result.candidates</span></span>?.[0]<span
class=GramE>?.<span class=SpellE>content?.parts</span></span>?.[0]?.<span
class=GramE>text;</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>textJson</span></span>) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>throw
new <span class=GramE>Error(</span>&quot;Gemini returned empty or invalid
content.&quot;<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>parsedResult</span> = <span class=SpellE>JSON.parse</span>(<span
class=SpellE>textJson</span><span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Add
actions to Ledger<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>for (const
item of <span class=SpellE>parsedResult.<span class=GramE>actions</span></span><span
class=GramE>) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>newCommitment</span> = {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>area: pillar,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>action: <span class=SpellE><span class=GramE>item.action</span></span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>owner: <span class=SpellE>userTeam</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>kpi</span>: <span class=SpellE>item.kpi</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>timeline: '30 Days',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>proof: 'LLM generated',<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await <span
class=SpellE><span class=GramE>addDoc</span></span><span class=GramE>(collection(</span><span
class=SpellE>db</span>, `/artifacts/${<span class=SpellE>appId</span>}/public/data/<span
class=SpellE>alliance_ledger</span>`), <span class=SpellE>newCommitment</span><span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Success<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>setLlmStatus</span></span><span class=GramE>(</span>{
<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>isLoading</span>: false, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>error:
null, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>targetPillar</span>: null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>message: `Success! Plan generated for ${pillar}. Summary: ${<span
class=SpellE>parsedResult.<span class=GramE>summary</span></span><span
class=GramE>}.</span> 3 commitments added to <span class=GramE>Ledger.`</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>return;</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} catch (<span
class=GramE>e) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>console.error</span></span>(`Attempt ${attempts}
<span class=GramE>failed:`</span>, e<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if
(attempts &lt; <span class=SpellE><span class=GramE>maxRetries</span></span><span
class=GramE>) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
delay = <span class=SpellE><span class=GramE>Math.pow</span></span><span
class=GramE>(</span>2, attempts) * <span class=GramE>1000;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>await
new <span class=GramE>Promise(</span>resolve =&gt; <span class=SpellE><span
class=GramE>setTimeout</span></span><span class=GramE>(</span>resolve, delay)<span
class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>} else {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE><span class=GramE>setLlmStatus</span></span><span class=GramE>(</span>{
<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>isLoading</span>: false, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>error: `Failed to generate plan after ${<span class=SpellE>maxRetries</span>}
<span class=GramE>attempts.`</span>, <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>targetPillar</span>: null,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>message: null<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>});<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}, [<span
class=SpellE>db</span>, <span class=SpellE>userTeam</span>, <span class=SpellE>llmStatus.isLoading</span>,
<span class=SpellE>appId</span>]<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// --- VIEW
RENDERERS ---<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>renderLeaderboard</span> = () =&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;p-4 space-y-8&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{/* User
Information <span class=GramE>*/}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;<span class=SpellE>bg</span>-white
shadow-md rounded-lg p-3 text-center text-<span class=SpellE>sm</span>
font-medium&quot; style<span class=GramE>={{ border</span>: `2px solid ${LEAP_<span
class=GramE>COLORS.BLUE}`</span> }}&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>You are
currently signed in as &lt;span <span class=SpellE>className</span>=&quot;font-mono
text-<span class=SpellE>xs</span> text-gray-600&quot;&gt;{<span class=SpellE>userId</span>}&lt;/span&gt;.
<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>You are
logged in as role: <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;span <span
class=SpellE>className</span>=&quot;font-extrabold ml-1&quot; style<span
class=GramE>={{ color</span>: <span class=GramE>LEAP_COLORS.RED }}&gt;</span>{<span
class=SpellE>userRole</span> || 'Unclaimed<span class=GramE>'}&lt;</span>/span&gt;.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;<span class=SpellE>bg</span>-white
shadow-xl rounded-2xl p-6&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h2 <span
class=SpellE>className</span>=&quot;text-2xl font-extrabold mb-4&quot; style<span
class=GramE>={{ color</span>: LEAP_<span class=GramE>COLORS.BLUE }}&gt;</span>&lt;Award
<span class=SpellE>className</span>=&quot;inline h-6 w<span class=GramE>-6</span>
mb-1 mr-2&quot; /&gt;Strategic Alliance Leaderboard&lt;/h2&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;space-y-4&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>leaderboard.map</span></span><span class=GramE>(</span>team
=&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
key={<span class=SpellE><span class=GramE>team.team</span></span>} <span
class=SpellE>className</span>=&quot;border-b pb-4 <span class=GramE>last:pb</span>-0
<span class=GramE>last:border</span>-b-0&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;flex justify-between items-center
mb-2&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h3
<span class=SpellE>className</span>=&quot;text-xl font-semibold
text-gray-800&quot;&gt;{<span class=SpellE><span class=GramE>team.team</span></span>}&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div <span class=SpellE>className</span>=&quot;flex items-center
space-x-4&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;label <span class=SpellE>className</span>=&quot;text-<span
class=SpellE>sm</span> font-medium text-gray-600&quot;&gt;Evidence Factor (0-<span
class=GramE>1):&lt;</span>/label&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;input<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>type=&quot;number&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>min=&quot;0&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>max=&quot;1&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>step=&quot;0.1&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>value={<span class=SpellE><span class=GramE>team.evidenceFactor</span></span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onChange</span><span class=GramE>={(</span>e) =&gt; <span
class=SpellE><span class=GramE>handleEvidenceFactorChange</span></span><span
class=GramE>(<span class=SpellE>team.team</span></span>, <span class=SpellE><span
class=GramE>e.target</span>.<span class=GramE>value</span></span><span
class=GramE>)}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>className</span><span class=GramE>={</span>`w-20 p-2 border-2
rounded-lg text-center font-mono <span class=GramE>focus:ring</span>-4
transition ${<span class=SpellE><span class=GramE>team.team</span></span><span
class=GramE> !=</span>= <span class=SpellE>userTeam</span> || <span
class=SpellE><span class=GramE>isTrainer</span></span><span class=GramE> ?</span>
'<span class=GramE>bg</span>-gray-100 opacity-70 cursor-not-allowed<span
class=GramE>' :</span> '<span class=GramE>'}`</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>style<span class=GramE>={{ <span class=SpellE>borderColor</span></span>:
LEAP_<span class=GramE>COLORS.BLUE }</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>disabled<span class=GramE>={<span class=SpellE>team.team</span> !=</span>=
<span class=SpellE>userTeam</span> || <span class=SpellE>isTrainer</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>/&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>ScoreBar</span> score={<span class=SpellE><span class=GramE>team.score</span></span>}
rank={<span class=SpellE><span class=GramE>team.rank</span></span>} /&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{/* Radar Chart
Placeholder (Simple Visualization) <span class=GramE>*/}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;<span class=SpellE>bg</span>-white
shadow-xl rounded-2xl p-6&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h2 <span
class=SpellE>className</span>=&quot;text-2xl font-extrabold mb-4&quot; style<span
class=GramE>={{ color</span>: LEAP_<span class=GramE>COLORS.BLUE }}&gt;</span>&lt;Zap
<span class=SpellE>className</span>=&quot;inline h-6 w<span class=GramE>-6</span>
mb-1 mr-2&quot; /&gt;Pillar Radar Data&lt;/h2&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;grid grid-<span class=GramE>cols</span>-1 <span
class=GramE>md:grid</span>-cols-2 gap-6&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>leaderboard.map</span></span><span class=GramE>(</span>team
=&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
key={<span class=SpellE><span class=GramE>team.team</span></span>} <span
class=SpellE>className</span>=&quot;p-4 border border-gray-200 rounded-xl
shadow-inner&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h4 <span
class=SpellE>className</span>=&quot;text-lg font-bold mb-3&quot; style<span
class=GramE>={{ color</span>: LEAP_<span class=GramE>COLORS.GREY }}&gt;</span>{<span
class=SpellE><span class=GramE>team.team</span></span>} Averages&lt;/h4&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE>Object.entries</span>(<span class=SpellE><span class=GramE>team.radar</span></span><span
class=GramE>).map</span>(([pillar, avg]) =&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div key={pillar} <span class=SpellE>className</span>=&quot;mb-2&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;p <span class=SpellE>className</span>=&quot;text-<span class=SpellE>sm</span>
font-medium&quot;&gt;{pillar} Excellence:&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div <span class=SpellE>className</span>=&quot;flex items-center
space-x-2&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div <span class=SpellE>className</span>=&quot;flex-grow bg-gray-100
rounded-full h-2.5&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;div <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span><span class=SpellE>className</span>=&quot;h-2.5 rounded-full
transition-all duration-500&quot; <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>style<span class=GramE>={</span>{ <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>width: `${(avg / 5) * <span class=GramE>100}%</span>`, // Max score is 5<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span><span class=SpellE>backgroundColor</span>: LEAP_COLORS.BLUE<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>}}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&gt;&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;span <span class=SpellE>className</span>=&quot;text-<span
class=SpellE>xs</span> font-semibold&quot; style<span class=GramE>={{ color</span>:
LEAP_<span class=GramE>COLORS.BLUE }}&gt;</span>{<span class=SpellE><span
class=GramE>avg.toFixed</span></span>(2<span class=GramE>)}&lt;</span>/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>renderBehaviors</span> = () =&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;p-4&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h2 <span
class=SpellE>className</span>=&quot;text-2xl font-extrabold mb-6&quot; style<span
class=GramE>={{ color</span>: LEAP_<span class=GramE>COLORS.BLUE }}&gt;</span>&lt;Users
<span class=SpellE>className</span>=&quot;inline h-6 w-6 mb-1 mr-2&quot;
/&gt;Behavior Scores (15) by Pillar and Team&lt;/h2&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>{!<span class=SpellE>userRole</span></span> &amp;&amp; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;bg-red-100 border border-red-400
text-red-700 px-4 py-3 rounded-xl mb-4 text-center font-semibold&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>You must
select a role on the startup screen to view or edit scores.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{/* LLM Status
and Action Plan Buttons <span class=GramE>*/}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE>userTeam</span> &amp;&amp; <span class=GramE>( /</span>/ Only show
LLM for team members<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;<span class=SpellE>bg</span>-white
shadow-xl rounded-2xl p-6 mb-6 space-y-4&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h3 <span
class=SpellE>className</span>=&quot;text-xl font-bold&quot; style<span
class=GramE>={{ color</span>: <span class=GramE>LEAP_COLORS.RED }}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>AI-Powered
Improvement Coach<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/h3&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE>llmStatus.<span class=GramE>isLoading</span></span><span
class=GramE> &amp;&amp;</span> (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;flex items-center space-x-3 text-lg
font-semibold text-orange-600&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>svg</span> <span class=SpellE>className</span>=&quot;animate-spin
h-5 w-5 text-orange-600&quot; <span class=SpellE>xmlns</span>=&quot;http://www.w3.org/2000/svg&quot;
fill=&quot;none&quot; <span class=SpellE>viewBox</span>=&quot;0 0 24
24&quot;&gt;&lt;circle <span class=SpellE>className</span>=&quot;opacity-25&quot;
cx=&quot;12&quot; cy=&quot;12&quot; r=&quot;10&quot; stroke=&quot;<span
class=SpellE>currentColor</span>&quot; <span class=SpellE>strokeWidth</span>=&quot;4&quot;&gt;&lt;/circle&gt;&lt;path
<span class=SpellE>className</span>=&quot;opacity-75&quot; fill=&quot;<span
class=SpellE>currentColor</span>&quot; d=&quot;M4 12a8 8 0 018-8V0C5.373 0 0
5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3
7.938l3-2.647z&quot;&gt;&lt;/path&gt;&lt;/<span class=SpellE>svg</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>Generating plan for {<span class=SpellE><span class=GramE>llmStatus.targetPillar</span></span><span
class=GramE>}...</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE>llmStatus.error</span> &amp;&amp; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;bg-red-100 border border-red-400
text-red-700 px-4 py-3 rounded-lg&quot;&gt;{<span class=SpellE><span
class=GramE>llmStatus.error</span></span><span class=GramE>}&lt;</span>/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE>llmStatus.message</span> &amp;&amp; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;bg-green-100 border border-green-400
text-green-700 px-4 py-3 rounded-lg&quot;&gt;{<span class=SpellE><span
class=GramE>llmStatus.message</span></span><span class=GramE>}&lt;</span>/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;flex flex-wrap gap-3&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>PILLARS.map</span></span><span class=GramE>(</span>pillar
=&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
avg = <span class=SpellE>currentUserPillarAverages</span>[pillar] || <span
class=GramE>0;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>isLow</span> = avg &lt; LOW_SCORE_THRESHOLD &amp;&amp; avg &gt; <span
class=GramE>0;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>isProcessing</span> = <span class=SpellE>llmStatus.isLoading</span>
&amp;&amp; <span class=SpellE>llmStatus.targetPillar</span> === <span
class=GramE>pillar;</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;button<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>key={pillar}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onClick</span><span class=GramE>={</span>() =&gt; <span
class=SpellE><span class=GramE>generateActionPlan</span></span><span
class=GramE>(</span>pillar, <span class=SpellE>currentTeamData.<span
class=GramE>behaviorScores</span></span><span class=GramE>)}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>className</span><span class=GramE>={</span>`flex items-center px-4
py-2 text-<span class=SpellE>sm</span> font-semibold rounded-lg transition
duration-300 shadow-md ${<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>isLow</span> <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>? '<span class=GramE>bg</span>-red-500 text-white hover:bg-red-600'<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>: 'bg-gray-200 text-gray-500 cursor-not-allowed'<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}`}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>disabled<span class=GramE>={</span>!<span class=SpellE>isLow</span> || <span
class=SpellE>llmStatus.isLoading</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;Sparkles <span class=SpellE>className</span>=&quot;h-4 w-4
mr-2&quot; /&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>isProcessing</span></span><span class=GramE> ?</span>
'Generating...<span class=GramE>' :</span> `Plan for ${pillar} (${<span
class=SpellE><span class=GramE>avg.toFixed</span></span>(<span class=GramE>2)}</span>/<span
class=GramE>5)`</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>})}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;p <span
class=SpellE>className</span>=&quot;text-<span class=SpellE>xs</span> italic
text-gray-500&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>A button
turns red when your team's score in that pillar drops below <span class=GramE>**{</span>LOW_SCORE_<span
class=GramE>THRESHOLD}*</span>*. Click it to auto-generate a 3-point action
plan for improvement using <span class=GramE>the Gemini</span> LLM.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>)}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{/* Scoreboard
Table <span class=GramE>*/}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;overflow-x-auto <span class=SpellE>bg</span>-white
rounded-2xl shadow-xl&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;table <span
class=SpellE>className</span>=&quot;min-w-full divide-y
divide-gray-200&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>thead</span> <span class=SpellE>className</span>=&quot;sticky <span
class=GramE>top-0</span> shadow-<span class=SpellE>sm</span>&quot; style<span
class=GramE>={{ <span class=SpellE>backgroundColor</span></span>: LEAP_<span
class=GramE>COLORS.BLUE }}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>th</span> <span class=SpellE>className</span>=&quot;px-6 py-3
text-left text-<span class=SpellE>xs</span> font-medium text-white uppercase
tracking-wider&quot;&gt;Pillar&lt;/<span class=SpellE>th</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>th</span> <span class=SpellE>className</span>=&quot;px-6 py-3
text-left text-<span class=SpellE>xs</span> font-medium text-white uppercase
tracking-wider&quot;&gt;Behavior&lt;/<span class=SpellE>th</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>TEAMS.map</span></span><span class=GramE>(</span>team
=&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>th</span> key={team} <span class=SpellE>className</span>=&quot;px-4
py-3 text-center text-<span class=SpellE>xs</span> font-medium text-white
uppercase tracking-wider&quot;&gt;{team}&lt;/<span class=SpellE>th</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/<span
class=SpellE>thead</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>tbody</span> <span class=SpellE>className</span>=&quot;<span
class=SpellE>bg</span>-white divide-y divide-gray-100&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>currentTeamData.behaviorScores.map</span></span><span
class=GramE>(</span>(item, index) =&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;tr
key={index} <span class=SpellE>className</span>=&quot;hover:bg-blue-50
transition&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
<span class=SpellE>className</span><span class=GramE>={</span>`px-6 py-3
whitespace-<span class=SpellE>nowrap</span> font-semibold ${index % 3 === <span
class=GramE>0 ?</span> '<span class=GramE>border</span>-t-2<span class=GramE>'
:</span> '<span class=GramE>'}`</span>} style<span class=GramE>={{ <span
class=SpellE>borderColor</span></span>: LEAP_<span class=GramE>COLORS.BLUE
}}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>item.pillar</span></span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;td
<span class=SpellE>className</span>=&quot;px-6 py-3 whitespace-<span
class=SpellE>nowrap</span> text-<span class=SpellE>sm</span>
text-gray-700&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>item.behavior</span></span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>TEAMS.map</span></span><span class=GramE>(</span>team
=&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>//
Find the score for this specific team (<span class=SpellE>docId</span>) and
this specific behavior<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>const <span class=SpellE>teamScores</span> = <span class=SpellE><span
class=GramE>allTeamData</span></span><span class=GramE>[</span>team<span
class=GramE>]?.</span><span class=SpellE>behaviorScores</span> || <span
class=SpellE><span class=GramE>initialScoresTemplate</span></span><span
class=GramE>;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>const score = <span class=SpellE>teamScores.find</span>(<span
class=SpellE>scoreItem</span> =&gt; <o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span><span class=SpellE>scoreItem.pillar</span> === <span class=SpellE><span
class=GramE>item.pillar</span></span> &amp;&amp; <span class=SpellE>scoreItem.behavior</span>
=== <span class=SpellE><span class=GramE>item.behavior</span></span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>)<span
class=GramE>?.score</span> || <span class=GramE>3;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>const <span class=SpellE>isEditable</span> = team === <span
class=SpellE>userTeam</span> &amp;<span class=GramE>&amp; !<span class=SpellE>isTrainer</span></span>;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>return (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;td key={team} <span class=SpellE>className</span>=&quot;px-4 py-2
whitespace-<span class=SpellE>nowrap</span> text-<span class=SpellE>sm</span>
text-center&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;<span class=SpellE>ScoreInput</span><o:p></o:p></p>

<p class=MsoNormal><span
style='mso-spacerun:yes'> </span>score={score}<o:p></o:p></p>

<p class=MsoNormal><span
style='mso-spacerun:yes'> </span><span
class=SpellE>onChange</span><span class=GramE>={(</span><span class=SpellE>newScore</span>)
=&gt; <span class=SpellE><span class=GramE>handleScoreChange</span></span><span
class=GramE>(</span>team, index, <span class=SpellE><span class=GramE>newScore</span></span><span
class=GramE>)}</span><o:p></o:p></p>

<p class=MsoNormal><span
style='mso-spacerun:yes'> </span>disabled=<span
class=GramE>{!<span class=SpellE>isEditable</span></span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>/&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/td&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>})}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/<span
class=SpellE>tbody</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/table&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>renderSettings</span> = () =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>currentTotal</span> = <span class=SpellE>PILLARS.reduce</span>((sum,
p) =&gt; sum + (weights[p] || 0), 0<span class=GramE>);</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>isTotalValid</span> = <span class=SpellE><span class=GramE>Math.abs</span></span><span
class=GramE>(</span><span class=SpellE>currentTotal</span> - 1.0) &lt; <span
class=GramE>0.001;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>totalColor</span> = <span class=SpellE><span class=GramE>isTotalValid</span></span><span
class=GramE> ?</span> '<span class=GramE>text</span>-green-600<span
class=GramE>' :</span> 'text-red-600<span class=GramE>';</span><o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;p-4 space-y-6&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h2 <span
class=SpellE>className</span>=&quot;text-2xl font-extrabold mb-4&quot; style<span
class=GramE>={{ color</span>: LEAP_<span class=GramE>COLORS.BLUE }}&gt;</span>&lt;Layers
<span class=SpellE>className</span>=&quot;inline h-6 w<span class=GramE>-6</span>
mb-1 mr-2&quot; /&gt;Pillar Weights (must total <span class=GramE>1.00)&lt;</span>/h2&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE>isTrainer</span> &amp;&amp; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;bg-yellow-100 border border-yellow-400 <span
class=GramE>text-</span>yellow-700 px-4 py-3 rounded-xl text-center
font-semibold&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>You are
logged in as Trainer (Read-Only). Weights cannot be edited.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;<span class=SpellE>bg</span>-white
shadow-xl rounded-2xl p-6 max-w-lg mx-auto&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;flex justify-between items-center mb-4 pb-2
border-b-2&quot; style<span class=GramE>={{ <span class=SpellE>borderColor</span></span>:
LEAP_<span class=GramE>COLORS.BLUE }}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;span <span
class=SpellE>className</span>=&quot;font-bold text-lg
text-gray-800&quot;&gt;Pillar&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;span <span
class=SpellE>className</span>=&quot;font-bold text-lg
text-gray-800&quot;&gt;Weight&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>PILLARS.map</span></span><span class=GramE>(</span>pillar
=&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div
key={pillar} <span class=SpellE>className</span>=&quot;flex justify-between
items-center py-3 border-b border-gray-100&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;span
<span class=SpellE>className</span>=&quot;text-lg font-medium
text-gray-700&quot;&gt;{pillar}&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;input<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>type=&quot;number&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>min=&quot;0&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>max=&quot;1&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>step=&quot;0.05&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>value={weights[<span class=GramE>pillar]}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onChange</span><span class=GramE>={(</span>e) =&gt; <span
class=SpellE><span class=GramE>handleWeightChange</span></span><span
class=GramE>(</span>pillar, <span class=SpellE>parseFloat</span>(<span
class=SpellE><span class=GramE>e.target</span>.value</span>) || 0)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>className</span><span class=GramE>={</span>`w-24 p-2 border-2
rounded-lg text-center font-mono <span class=GramE>focus:ring</span>-4
transition ${<span class=SpellE><span class=GramE>isTrainer</span></span><span
class=GramE> ?</span> '<span class=GramE>bg</span>-gray-100 opacity-70
cursor-not-allowed<span class=GramE>' :</span> '<span class=GramE>'}`</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>style<span
class=GramE>={{ <span class=SpellE>borderColor</span></span>: LEAP_<span
class=GramE>COLORS.BLUE }</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>disabled={<span class=SpellE>isTrainer</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>/&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;mt-6 pt-4 border-t-2 flex justify-between
items-center&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;span <span
class=SpellE>className</span>=&quot;font-bold text-xl
text-gray-800&quot;&gt;Total:&lt;/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;span <span
class=SpellE>className</span><span class=GramE>={</span>`font-extrabold
text-2xl ${<span class=SpellE>totalColor</span>}`}&gt;{<span class=SpellE>currentTotal.toFixed</span>(2<span
class=GramE>)}&lt;</span>/span&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;p <span
class=SpellE>className</span>=&quot;mt-4 text-<span class=SpellE>sm</span>
italic&quot; style<span class=GramE>={{ color</span>: LEAP_<span class=GramE>COLORS.GREY
}}&gt;</span>Adjust the weights to change the scoring model. Total must be 1.00
for accurate <span class=GramE>scores.&lt;</span>/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>renderAllianceLedger</span> = () =&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;p-4&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;flex justify-between items-center
mb-6&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h2 <span
class=SpellE>className</span>=&quot;text-2xl font-extrabold&quot; style<span
class=GramE>={{ color</span>: LEAP_<span class=GramE>COLORS.BLUE }}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>TrendingUp</span> <span class=SpellE>className</span>=&quot;inline
h-6 w-6 mb-1 mr-2&quot; /&gt;Alliance Ledger (30-day Commitments)<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/h2&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;button<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onClick</span>={<span class=SpellE>handleLedgerAdd</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>className</span>=&quot;flex items-center px-4 py-2 text-<span
class=SpellE>sm</span> font-semibold rounded-lg text-white transition
duration-300 shadow-md <span class=SpellE><span class=GramE>hover:shadow</span>-lg</span>&quot;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>style<span
class=GramE>={{ <span class=SpellE>backgroundColor</span></span>: LEAP_<span
class=GramE>COLORS.BLUE }</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>PlusCircle</span> <span class=SpellE>className</span>=&quot;h-5
w-5 mr-2&quot; /&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>Add New
Commitment<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;overflow-x-auto <span class=SpellE>bg</span>-white
rounded-2xl shadow-xl&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;table <span
class=SpellE>className</span>=&quot;min-w-full divide-y
divide-gray-200&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>thead</span> <span class=SpellE>className</span>=&quot;sticky <span
class=GramE>top-0</span> shadow-<span class=SpellE>sm</span>&quot; style<span
class=GramE>={{ <span class=SpellE>backgroundColor</span></span>: LEAP_<span
class=GramE>COLORS.BLUE }}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>{['Area', 'Action', 'Owner', 'KPI', 'Timeline', 'Proof', 'Actions'<span
class=GramE>].map</span>(header =&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>th</span> key={header} <span class=SpellE>className</span>=&quot;px-4
py-3 text-left text-<span class=SpellE>xs</span> font-medium text-white
uppercase tracking-wider&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>{header}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/<span
class=SpellE>th</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/tr&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/<span
class=SpellE>thead</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>tbody</span> <span class=SpellE>className</span>=&quot;<span
class=SpellE>bg</span>-white divide-y divide-gray-100&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>ledgerItems.map</span></span><span class=GramE>(</span>item
=&gt; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;<span
class=SpellE>LedgerRow</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>key={item.id}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>item={item}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onEdit</span>={<span class=SpellE>handleLedgerEdit</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onDelete</span>={<span class=SpellE>handleLedgerDelete</span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>/&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>))}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/<span
class=SpellE>tbody</span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/table&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE>ledgerItems.length</span> === 0 &amp;&amp; (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;p <span
class=SpellE>className</span>=&quot;p-6 text-center text-gray-500
italic&quot;&gt;No commitments recorded. Click &quot;Add New Commitment&quot;
to start <span class=GramE>tracking!&lt;</span>/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;p <span
class=SpellE>className</span>=&quot;p-4 text-<span class=SpellE>sm</span>
italic&quot; style<span class=GramE>={{ color</span>: LEAP_<span class=GramE>COLORS.GREY
}}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>This ledger
tracks team commitments to improve pillar scores. Edit fields directly to
update records.<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// --- MAIN APP
STRUCTURE ---<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>renderView</span> = () =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Show loading or
team selection until ready<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>isAuthReady</span></span>) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return &lt;div
<span class=SpellE>className</span>=&quot;p-10 text-center
text-gray-500&quot;&gt;Connecting to Firebase...&lt;/div<span class=GramE>&gt;;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>if <span
class=GramE>(!<span class=SpellE>userRole</span></span>) {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return &lt;<span
class=SpellE>TeamSelectionModal</span> teams={TEAMS} <span class=SpellE>onSelect</span>={<span
class=SpellE>handleRoleClaim</span>} /<span class=GramE>&gt;;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>// Main navigation
and view rendering<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>switch (<span
class=SpellE><span class=GramE>activeTab</span></span><span class=GramE>) {</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case 'Settings':
return <span class=SpellE><span class=GramE>renderSettings</span></span><span
class=GramE>();</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case
'Behaviors': return <span class=SpellE><span class=GramE>renderBehaviors</span></span><span
class=GramE>();</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case 'Alliance
Ledger': return <span class=SpellE><span class=GramE>renderAllianceLedger</span></span><span
class=GramE>();</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>case
'Leaderboard':<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>default: return <span
class=SpellE><span class=GramE>renderLeaderboard</span></span><span
class=GramE>();</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>navItems</span> = [<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=GramE>{
name</span>: 'Leaderboard', icon: <span class=GramE>Award }</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=GramE>{
name</span>: 'Behaviors', icon: <span class=SpellE><span class=GramE>Cpu</span></span><span
class=GramE> }</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=GramE>{
name</span>: 'Settings', icon: <span class=GramE>Layers }</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span class=GramE>{
name</span>: 'Alliance Ledger', icon: <span class=SpellE><span class=GramE>TrendingUp</span></span><span
class=GramE> }</span>,<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>];<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;min-h-screen bg-gray-50 font-sans&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{/* Header <span
class=GramE>*/}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;header <span
class=SpellE>className</span>=&quot;py-4 shadow-lg&quot; style<span
class=GramE>={{ <span class=SpellE>backgroundColor</span></span>: LEAP_<span
class=GramE>COLORS.BLUE }}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;max-w-7xl mx-auto px-4 <span class=GramE>sm:px</span>-6
<span class=GramE>lg:px</span>-<span class=GramE>8 flex</span> flex-<span
class=GramE>col</span> <span class=SpellE><span class=GramE>sm:flex</span>-row</span>
justify-between items-center&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;h1 <span
class=SpellE>className</span>=&quot;text-2xl sm:text-3xl font-extrabold
tracking-tight text-white mb-3 <span class=GramE>sm:mb</span>-0&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>Strategic
Alliance Scoreboard<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/h1&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/header&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{/* Navigation
Tabs <span class=GramE>*/}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;nav <span
class=SpellE>className</span>=&quot;shadow-md <span class=SpellE>bg</span>-white&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;max-w-7xl mx-auto px-2 <span class=GramE>sm:px</span>-6
<span class=GramE>lg:px</span>-8&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;flex justify-start space-x-1 <span
class=GramE>sm:space</span>-x-4&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>{<span class=SpellE>navItems.map</span>((</span>item) =&gt; {<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const
Icon = <span class=SpellE><span class=GramE>item.icon</span></span>;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>const <span
class=SpellE>isActive</span> = <span class=SpellE>activeTab</span> === <span
class=GramE>item.name;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>return (<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;button<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>key={item.name}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>onClick</span><span class=GramE>={</span>() =&gt; <span
class=SpellE>setActiveTab</span>(<span class=GramE>item.name)}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>className</span><span class=GramE>={</span>`flex items-center px-3
py-2 text-<span class=SpellE>sm</span> font-medium rounded-t-lg transition-all
duration-300 ${<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>isActive</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>? '<span class=GramE>shadow</span>-lg border-b-4 border-blue-500
text-gray-900 bg-gray-100'<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>: 'text-gray-500 hover:text-gray-900 hover:bg-gray-50'<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>}`}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>style<span class=GramE>={<span class=SpellE>isActive</span> ?</span> <span
class=GramE>{ <span class=SpellE>borderColor</span></span>: LEAP_<span
class=GramE>COLORS.BLUE }</span> : {}}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;Icon <span class=SpellE>className</span>=&quot;h-5 w-5 mr-1
sm:mr-2&quot; /&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>{item.name}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'>
</span>&lt;/button&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>})}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/nav&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{/* Main Content
<span class=GramE>*/}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;main <span
class=SpellE>className</span>=&quot;max-w-7xl mx-auto py-6 <span class=GramE>sm:px</span>-6
<span class=GramE>lg:px</span>-8&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;div <span
class=SpellE>className</span>=&quot;px-4 <span class=GramE>sm:px</span>-0&quot;&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{<span
class=SpellE><span class=GramE>renderView</span></span><span class=GramE>(</span>)}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/main&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{/* Footer <span
class=GramE>*/}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;footer <span
class=SpellE>className</span>=&quot;w-full py-3 mt-10 text-center&quot; style<span
class=GramE>={{ <span class=SpellE>backgroundColor</span>: '#</span>F3F4F6<span
class=GramE>' }}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;p <span
class=SpellE>className</span>=&quot;text-<span class=SpellE>sm</span>
italic&quot; style<span class=GramE>={{ color</span>: LEAP_<span class=GramE>COLORS.GREY
}}&gt;</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=SpellE>LeapToSuccess</span> | Transforming Talent into Performance<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/p&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/footer&gt;<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>{/* Team
Selection Modal rendered outside main content if <span class=SpellE>userRole</span>
is not set <span class=GramE>*/}</span><o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span><span
class=GramE>{!<span class=SpellE>userRole</span></span> &amp;&amp; <span
class=SpellE>isAuthReady</span> &amp;&amp; &lt;<span class=SpellE>TeamSelectionModal</span>
teams={TEAMS} <span class=SpellE>onSelect</span>={<span class=SpellE>handleRoleClaim</span>}
/&gt;}<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>&lt;/div&gt;<o:p></o:p></p>

<p class=MsoNormal><span style='mso-spacerun:yes'> </span>);<o:p></o:p></p>

<p class=MsoNormal>};<o:p></o:p></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>export default <span class=GramE>App;</span></p>

</div>

</body>

</html>
